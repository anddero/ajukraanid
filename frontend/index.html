<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Ajukraanid</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="vue.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css">
    <link rel="shortcut icon" href="https://mdbootstrap.com/wp-content/themes/mdbootstrap4/favicon.ico">
    <style>
    	body, html {
    	    height: 100%;
    	}

    	.bg { 
    	    /* The image used */
    	    background-image: url("yellow.jpg");

    	    /* Full height */
    	    height: 100%; 

    	    /* Center and scale the image nicely */
    	    background-position: center;
    	    background-repeat: no-repeat;
    	    background-size: cover;
    	}
        .logo {
            padding-top: 30px;
            padding-bottom: 30px;
            margin-bottom: 30px;
            color: inherit;
            text-align: center;
            box-sizing: border-box;
        }
        .grow { transition: all .2s ease-in-out; }
        .grow:hover { transform: scale(1.1); }
    </style>
    
</head>
<body>
        
        <div id="game" class="bg">
            <div id="hidden"></div>
            <div id="errorMessages"></div>
              
            <div v-if="tabNr==0">
                <div class="logo">
                    <input type="image" src="logo.png"/>
                </div>
                               
                <div class="log">
                    <table style="margin:auto; text-align:center">
                        <tr>
                            <td><input class="grow" type="image" src="playgame.png" v-on:click="playTheGame()"/></td>
                        </tr>
                        <tr>
                            <td><input class="grow" type="image" src="make.png" v-on:click="makeTheGame()"/></td>
                        </tr>
                        <tr>
                            <td><input class="grow" type="image" src="settings.png" v-on:click="switchTab(3)"/></td>
                        </tr>
                    </table>   
                </div>
            </div>
             
            <div v-if="tabNr==1">
                1
                <div class="logo">
                    <input type="image" src="logo.png"/>
                </div>
                                   
                <div class="form-group" style="margin:auto; text-align:center">
                    <input type="text" class="form-control" id="name" v-model="newName" placeholder="YOUR NAME" style="width: 200px; text-align:center; margin:auto"/><br>
                    <input type="number" class="form-control" id="code" v-model="newCode" placeholder="GAME CODE" style="width: 200px; text-align:center; margin:auto"/><br>
                    <input class="grow" type="image" src="play.png" value="Lisa" v-on:click="startGame()"/>                 
                </div>
            </div>
               
            <div v-if="tabNr==2">
                2
                <div class="logo">
                    <input type="image" src="logo.png"/>
                </div>
                <div id="forRandomNumber" style="margin:auto; text-align:center">
                        
                </div>                   
                <div class="form-group" style="margin:auto; text-align:center">
                    <input type="text" class="form-control" id="name" v-model="newName" placeholder="YOUR NAME" style="width: 200px; text-align:center; margin:auto"/><br>
                    <input type="number" class="form-control" id="code" v-model="newCode" placeholder="GAME CODE" style="width: 200px; text-align:center; margin:auto"/><br>
                    <input class="grow" type="image" src="play.png" value="Lisa" v-on:click="startGame()"/>                      
                </div>
            </div>        
   
            <div v-if="tabNr==3">
                3
                <div class="logo">
                    <input type="image" src="logo.png"/>
                </div>
                                           
                <div class="log">
                    <table style="margin:auto; text-align:center">
                        <tr>
                            <td><input class="grow" type="image" src="settings.png" v-on:click="switchTab(3)"/></td>
                        </tr>
                    </table>   
                </div>
            </div>

            <div v-if="tabNr==4">
                4
                <div class="logo">
                    <input type="image" src="logo.png"/>
                </div>
                <div id="forRandomNumber" style="margin:auto; text-align:center">
                    
                </div>                   
                <div class="form-group" style="margin:auto; text-align:center">
                    <input type="text" class="form-control" id="name" v-model="newName" placeholder="YOUR NAME" style="width: 200px; text-align:center; margin:auto"/><br>
                    <input type="number" class="form-control" id="code" v-model="newCode" placeholder="WRONG CODE" style="width: 200px; background:brown; text-align:center; margin:auto"/><br>
                    <input class="grow" type="image" src="play.png" value="Lisa" v-on:click="startGame()"/>        
                </div>
            </div>

            <div v-if="tabNr==5">
                5
                <div class="logo">
                    <input type="image" src="logo.png"/>
                </div>
                                           
                <div class="log">
                    <table style="margin:auto; text-align:center">
                        <tr>
                            <td>Lobby</td>
                        </tr>
                    </table>   
                </div>
            </div>
        </div>        
            
<script>
var vm = new Vue({
    el: "#game",
    data: {
        tabNr: 0,
        theRandomNumber: "",
        newCode: "",
        newName: ""
    },
    methods: {
        startGame: function(){
            var myObject = new Object();
            myObject.Action = "JoinGame";
            myObject.Code = document.getElementById("code").value;
            myObject.Name = document.getElementById("name").value;
            fetch('http://localhost:8080', {
                method: 'post',
                headers: {
                    'Accept': 'application/json, text/plain, */*',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(myObject)
            }).then(res=>res.json())
            .then(function(res)
            {
                if (res.State == "Error") {
                    this.tabNr = 4;
                } else {
                    this.tabNr = 5;
                }
            })
            ;
        },
        playTheGame: function() {
            this.tabNr = 1;
        },
        switchTab: function(a) { 
            this.tabNr = a;
        },
        makeTheGame: function() {
            this.tabNr = 2;
            var randomCode = "";
            var myObject = new Object();
            myObject.Action = "CreateGame";
            var dataToBePosted = JSON.stringify(myObject);

            var http = new XMLHttpRequest();
            var url = "http://localhost:8080/";
            http.onreadystatechange = function() {
                if (http.readyState == 4 && http.status == 200) {
                    document.getElementById("forRandomNumber").innerHTML = JSON.parse(http.responseText).Code;
                }
            }
            http.open("POST", url, true);
            http.setRequestHeader("Content-type", "application/json; charset=utf-8");
            http.send(dataToBePosted);
        }
    }
});
</script>
</body>
</html>